openapi: 3.0.3
info:
  title: OnlyDust Backoffice API
  description: OnlyDust Backoffice API
  version: 1.0.0
servers:
  - url: 'http://localhost:9999'
    description: Local
  - url: 'https://develop-api.onlydust.com'
    description: Develop
  - url: 'https://staging-api.onlydust.com'
    description: Staging
  - url: 'https://api.onlydust.com'
    description: Production

paths:
  # BackofficeInvoicingManagement ===============================================================
  /bo/v1/me:
    get:
      security:
        - bearerAuth: [ ]
      tags:
        - BackofficeMe
      summary: Get my information
      operationId: getMe
      description: |
        Get my information
      responses:
        "200":
          description: 'Me'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MeResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/invoices:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeInvoicingManagement
      summary: Get invoice page
      operationId: getInvoicePage
      description: |
        Get invoice page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: invoiceIds
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/InvoiceId'
          style: form
        - in: query
          name: internalStatuses
          required: false
          schema:
            type: array
            default: [ TO_REVIEW, REJECTED, APPROVED, PAID ]
            items:
              $ref: '#/components/schemas/InvoiceInternalStatus'
          style: form
      responses:
        "200":
          description: 'Invoice page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvoicePage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v2/invoices:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeInvoicingManagement
      summary: Get invoice page
      operationId: getInvoicePageV2
      description: |
        Get invoice page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: invoiceIds
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/InvoiceId'
          style: form
        - in: query
          name: statuses
          required: false
          schema:
            type: array
            default: [ TO_REVIEW, REJECTED, APPROVED, PAID ]
            items:
              $ref: '#/components/schemas/InvoiceInternalStatus'
          style: form
      responses:
        "200":
          description: 'Invoice page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvoicePageV2'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/invoices/{invoiceId}:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeInvoicingManagement
      summary: Get invoice
      operationId: getInvoice
      description: |
        Get invoice details
      parameters:
        - in: path
          name: invoiceId
          required: true
          schema:
            $ref: '#/components/schemas/InvoiceId'
      responses:
        "200":
          description: 'Invoice'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvoiceResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
  /bo/v1/invoices/{invoiceId}/status:
    put:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeInvoicingManagement
      summary: Update invoice's status
      operationId: updateInvoiceStatus
      description: |
        Update invoice's status to APPROVED or REJECTED.
      parameters:
        - in: path
          name: invoiceId
          required: true
          schema:
            $ref: '#/components/schemas/InvoiceId'
      requestBody:
        description: Invoice
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateInvoiceStatusRequest'
      responses:
        "204":
          description: 'The invoice status has been updated'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/external/invoices/{invoiceId}:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeInvoicingManagement
      summary: Download invoice by id
      operationId: downloadInvoice
      parameters:
        - in: path
          name: invoiceId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: 'Pdf as blob'
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  # BackofficeAccountingManagement ===============================================================
  /bo/v1/sponsors/{sponsorId}/accounts:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Create a new account for the given sponsor
      operationId: createSponsorAccount
      description: |
        Create a new account for the given sponsor.
        An account allows to:
          - register physical transactions (from the real world) by providing transaction receipts.
          - make funds available for internal transactions between the sponsor and projects (and eventually contributors) by providing an allowance.
      parameters:
        - in: path
          name: sponsorId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorId'
      requestBody:
        description: Account
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountRequest'
      responses:
        "200":
          description: 'The account has been created'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Get sponsor accounts
      operationId: getSponsorAccounts
      parameters:
        - in: path
          name: sponsorId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorId'
      responses:
        "200":
          description: 'The sponsor accounts'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountListResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/sponsor-accounts/{accountId}/allowance:
    put:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Update the allowance of the given account.
      operationId: updateAccountAllowance
      description: |
        Update the allowance of the given account, making funds available for internal transactions 
        between the sponsor and projects (and eventually contributors).
        
        Specify the amount to add or remove from the current allowance.
      parameters:
        - in: path
          name: accountId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorAccountId'
      requestBody:
        description: New allowance
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAccountAllowanceRequest'
      responses:
        "200":
          description: 'The account allowance has been updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/sponsor-accounts/{accountId}/receipts:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Update the balance of the given account by providing a transaction receipt.
      operationId: registerTransactionReceipt
      description: |
        Update the (physical) balance of the given account by providing a transaction receipt (from the real world).
        This will return an error if the new balance is negative.
        This will return an error if the receipt's network is different from the account's network.
      parameters:
        - in: path
          name: accountId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorAccountId'
      requestBody:
        description: Transaction receipt to register
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterTransactionReceiptRequest'
      responses:
        "200":
          description: 'The transaction receipt has been registered and account balance has been updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionReceipt'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/sponsor-accounts/{accountId}/receipts/{receiptId}:
    delete:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Update the balance of the given account by removing a transaction receipt.
      operationId: removeTransactionReceipt
      description: |
        Update the (physical) balance of the given account by removing a transaction receipt (from the real world).
      parameters:
        - in: path
          name: accountId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorAccountId'
        - in: path
          name: receiptId
          required: true
          schema:
            $ref: '#/components/schemas/TransactionReceiptId'
      responses:
        "200":
          description: 'The transaction receipt has been removed and the account balance has been updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/sponsor-accounts/{accountId}:
    patch:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Update some attributes of the account
      operationId: updateAccountAttributes
      description: |
        Update some attributes of the account.
      parameters:
        - in: path
          name: accountId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorAccountId'
      requestBody:
        description: Account attributes to update
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAccountRequest'
      responses:
        "200":
          description: 'The account has been updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/projects/{projectId}/budgets/allocate:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Allocate a budget to a project
      operationId: allocateBudgetToProject
      description: Allocate a budget to a project
      parameters:
        - in: path
          name: projectId
          required: true
          schema:
            $ref: '#/components/schemas/ProjectId'
      requestBody:
        description: Budget to allocate
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectBudgetAllocationRequest'
      responses:
        "204":
          description: 'The funds have been allocated'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/projects/{projectId}/budgets/unallocate:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Refund a sponsor by unallocating funds from a project
      operationId: unallocateBudgetFromProject
      description: Refund a sponsor
      parameters:
        - in: path
          name: projectId
          required: true
          schema:
            $ref: '#/components/schemas/ProjectId'
      requestBody:
        description: Budget to unallocate
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectBudgetAllocationRequest'
      responses:
        "204":
          description: 'The funds have been unallocated'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/pending-payments:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Get pending payments
      operationId: getPendingPayments
      description: |
        Get list of payments to process. 
        The returned list should contain all necessary information to process the payments.
        Also, all payments present in the list are payable (all required conditions are matched).
      responses:
        "200":
          description: 'List of payments to process'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PendingPaymentListResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/rewards/{rewardId}/pay:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Pay a reward
      operationId: payReward
      description: |
        Pay a reward using the transaction reference and recipient account as input.
        The provided reward will be marked as complete.
      parameters:
        - in: path
          name: rewardId
          required: true
          schema:
            $ref: '#/components/schemas/RewardId'
      requestBody:
        description: Payment information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayRewardRequest'
      responses:
        "204":
          description: 'The reward has been marked as complete'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v0/rewards/{rewardId}/pay:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Pay a reward
      operationId: oldPayReward
      description: |
        Pay a reward using the transaction reference and recipient account as input.
        The provided reward will be marked as complete.
      parameters:
        - in: path
          name: rewardId
          required: true
          schema:
            $ref: '#/components/schemas/RewardId'
      requestBody:
        description: Payment information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayRewardRequest'
      responses:
        "204":
          description: 'The reward has been marked as complete'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/rewards:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Get all (paginated) rewards
      operationId: getRewards
      description: |
        Get paginated rewards
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: statuses
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/RewardStatus'
          style: form
        - in: query
          name: fromRequestedAt
          required: false
          schema:
            type: string
            pattern: '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
        - in: query
          name: toRequestedAt
          required: false
          schema:
            type: string
            pattern: '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
        - in: query
          name: fromProcessedAt
          required: false
          schema:
            type: string
            pattern: '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
        - in: query
          name: toProcessedAt
          required: false
          schema:
            type: string
            pattern: '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
      responses:
        "200":
          description: 'Page of rewards'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RewardPageResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/rewards/search:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Search rewards
      operationId: searchRewards
      description: |
        Search rewards
      requestBody:
        description: Payment information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRewardsRequest'
      responses:
        "200":
          description: 'List of rewards'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchRewardsResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/rewards/batch-payments:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Create a batch payments for a given list of invoice ids
      operationId: createBatchPayments
      description: |
        Create a batch payments for a given list of invoice ids
      requestBody:
        description: List of invoice ids
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostBatchPaymentRequest'
      responses:
        "200":
          description: 'List of batch payment'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchPaymentsResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Get batch payments
      operationId: getBatchPayments
      description: |
        Get page of paid batch payments
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 'Page of paid batch payments'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchPaymentPageResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/rewards/batch-payments/{batchPaymentId}:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Get batch payment details
      operationId: getBatchPayment
      description: |
        Get batch payment details
      parameters:
        - in: path
          name: batchPaymentId
          required: true
          schema:
            $ref: '#/components/schemas/BatchPaymentId'
      responses:
        "200":
          description: Batch payment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchPaymentDetailsResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
    put:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeAccountingManagement
      summary: Update batch payment with transaction hash
      operationId: updateBatchPayments
      description: |
        Update batch payment with transaction hash
      parameters:
        - in: path
          name: batchPaymentId
          required: true
          schema:
            $ref: '#/components/schemas/BatchPaymentId'
      requestBody:
        description: Transaction hash
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchPaymentRequest'
      responses:
        "204":
          description: 'Batch payment processed'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'



  # BackofficeSponsorManagement ===============================================================
  /bo/v1/sponsors:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeSponsorManagement
      summary: Get sponsor page
      operationId: getSponsorPage
      description: |
        Get sponsor page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
        - in: query
          name: sponsorIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Sponsor page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SponsorPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeSponsorManagement
      summary: Add a new sponsor
      operationId: createSponsor
      description: |
        Add a new sponsor
      requestBody:
        description: Sponsor to add
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SponsorRequest'
      responses:
        "201":
          description: 'Sponsor created'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SponsorResponse'
        "400":
          $ref: '#/components/responses/BadRequestError'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "404":
          $ref: '#/components/responses/NotFoundError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/sponsors/{sponsorId}:
    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeSponsorManagement
      summary: Get sponsor data
      operationId: getSponsor
      description: |
        Get sponsor data
      parameters:
        - in: path
          name: sponsorId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorId'
      responses:
        "200":
          description: 'Sponsor data'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SponsorResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

    put:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeSponsorManagement
      summary: Modify sponsor data
      operationId: updateSponsor
      description: Modify sponsor data
      parameters:
        - in: path
          name: sponsorId
          required: true
          schema:
            $ref: '#/components/schemas/SponsorId'
      requestBody:
        description: Sponsor data to update
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SponsorRequest'
      responses:
        "200":
          description: 'Sponsor updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SponsorResponse'
        "400":
          $ref: '#/components/responses/BadRequestError'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "404":
          $ref: '#/components/responses/NotFoundError'
        "500":
          $ref: '#/components/responses/InternalServerError'
  /bo/v1/ecosystems:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get ecosystem page
      operationId: getEcosystemPage
      description: |
        Get ecosystem page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
        - in: query
          name: ecosystemIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Ecosystem page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EcosystemPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
    post:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Create ecosystem
      operationId: postEcosystem
      description: |
        Create ecosystem
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EcosystemRequest'
      responses:
        "200":
          description: 'Ecosystem page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EcosystemResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
  # Backoffice ===============================================================
  /bo/v1/repositories:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get github repository page
      operationId: getGithubRepositoryPage
      description: |
        Get github repository page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Github repository page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GithubRepositoryPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
  /bo/v1/budgets:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get budget page
      operationId: getBudgetPage
      description: |
        Get budget page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Budget page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'
  /bo/v1/project-lead-invitations:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get project lead invitations page
      operationId: getProjectLeadInvitationPage
      description: |
        Get project lead invitations page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: ids
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Project Lead Invitation page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectLeadInvitationPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'


  /bo/v1/users:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get user page
      operationId: getUserPage
      description: |
        Get user page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: userIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
      responses:
        "200":
          description: 'User page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/payments:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get payment page
      operationId: getPaymentPage
      description: |
        Get payment page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
        - in: query
          name: paymentIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Payment page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/projects:
    get:
      security:
        - apiKey: [ ]
      tags:
        - Backoffice
      summary: Get project page
      operationId: getProjectPage
      description: |
        Get project page
      parameters:
        - in: query
          name: pageIndex
          required: true
          schema:
            type: integer
        - in: query
          name: pageSize
          required: true
          schema:
            type: integer
        - in: query
          name: projectIds
          required: false
          schema:
            type: array
            items:
              type: string
              format: uuid
          style: form
      responses:
        "200":
          description: 'Project page'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectPage'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  # BackofficeCurrencyManagement ===============================================================

  /bo/v1/currencies:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeCurrencyManagement
      summary: Add support of a new currency
      operationId: createCurrency
      description: Add support of a new currency
      requestBody:
        description: Currency to add
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CurrencyCreateRequest'
      responses:
        "200":
          description: 'Currency is now supported'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CurrencyResponse'
        "400":
          $ref: '#/components/responses/BadRequestError'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "404":
          $ref: '#/components/responses/NotFoundError'
        "500":
          $ref: '#/components/responses/InternalServerError'

    get:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeCurrencyManagement
      summary: List all supported currencies
      operationId: listCurrencies
      description: List all supported currencies
      responses:
        "200":
          description: 'List of all supported currencies'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CurrencyListResponse'
        "400":
          $ref: '#/components/responses/BadRequestError'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "404":
          $ref: '#/components/responses/NotFoundError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/currencies/{currencyId}:
    put:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeCurrencyManagement
      summary: Modify currency data
      operationId: updateCurrency
      description: Modify currency data
      parameters:
        - in: path
          name: currencyId
          required: true
          schema:
            $ref: '#/components/schemas/CurrencyId'
      requestBody:
        description: Currency data to update
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CurrencyUpdateRequest'
      responses:
        "200":
          description: 'Currency has been updated'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CurrencyResponse'
        "400":
          $ref: '#/components/responses/BadRequestError'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "404":
          $ref: '#/components/responses/NotFoundError'
        "500":
          $ref: '#/components/responses/InternalServerError'

  /bo/v1/currencies/logos:
    post:
      security:
        - apiKey: [ ]
      tags:
        - BackofficeCurrencyManagement
      summary: Upload a currency logo
      operationId: uploadLogo
      requestBody:
        content:
          image/png:
            schema:
              type: string
              format: binary
          image/jpeg:
            schema:
              type: string
              format: binary
          image/svg+xml:
            schema:
              type: string
              format: binary
          image/webp:
            schema:
              type: string
              format: binary
      responses:
        "200":
          description: 'Image uploaded'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadImageResponse'
        "401":
          $ref: '#/components/responses/UnauthorizedError'
        "500":
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    apiKey:
      type: apiKey
      in: header
      name: Api-Key
  responses:
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          example:
            message: Github API is not responding
            status: 500
            id: 4f7c660e-6cf1-4424-b240-e630c4c19069
          schema:
            $ref: '#/components/schemas/OnlyDustError'
    UnauthorizedError:
      description: Unauthorized
      content:
        application/json:
          example:
            message: You must be authenticated to make this call
            status: 401
            id: 4f7c660e-6cf1-4424-b240-e630c4c19069
          schema:
            $ref: '#/components/schemas/OnlyDustError'
    BadRequestError:
      description: Bad request
      content:
        application/json:
          example:
            message: The request is invalid
            status: 404
            id: 4f7c660e-6cf1-4424-b240-e630c4c19069
          schema:
            $ref: '#/components/schemas/OnlyDustError'
    NotFoundError:
      description: Not found
      content:
        application/json:
          example:
            message: The requested resource was not found
            status: 404
            id: 4f7c660e-6cf1-4424-b240-e630c4c19069
          schema:
            $ref: '#/components/schemas/OnlyDustError'

  schemas:
    # ERRORS ==================================================================
    OnlyDustError:
      type: object
      description: Error contract strongly inspired by JSON problem (rfc7807) specification
      required:
        - message
        - status
        - id
      properties:
        message:
          type: string
          description: A short, human-readable summary of the problem type. It SHOULD NOT change from occurrence to occurrence of the problem.
          example: Not enough credit.
        status:
          type: integer
          description: The HTTP status code generated by the origin server for this occurrence of the problem.
          example: 400
        id:
          type: string
          format: uuid
          description: The error id
          example: 4f7c660e-6cf1-4424-b240-e630c4c19069

    MeResponse:
      type: object
      required:
        - email
        - name
        - roles
      properties:
        email:
          type: string
        name:
          type: string
        avatarUrl:
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/BackofficeUserRole'

    BackofficeUserRole:
      type: string
      enum:
        - BO_ADMIN
        - BO_READER

    GithubRepositoryPage:
      type: object
      required:
        - contributors
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        githubRepositories:
          type: array
          items:
            $ref: '#/components/schemas/GithubRepositoryResponse'

    SponsorPage:
      type: object
      required:
        - sponsors
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        sponsors:
          type: array
          items:
            $ref: '#/components/schemas/SponsorPageItemResponse'

    SponsorPageItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        url:
          type: string
        logoUrl:
          type: string
        projectIds:
          type: array
          items:
            type: string
            format: uuid

    SponsorResponse:
      allOf:
        - $ref: '#/components/schemas/SponsorPageItemResponse'
        - type: object
          properties:
            refundableBalances:
              type: array
              items:
                $ref: '#/components/schemas/TransactionData'
            availableBudgets:
              type: array
              items:
                $ref: '#/components/schemas/AllocationData'

    EcosystemPage:
      type: object
      required:
        - ecosystems
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        ecosystems:
          type: array
          items:
            $ref: '#/components/schemas/EcosystemPageItemResponse'

    EcosystemPageItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        url:
          type: string
        logoUrl:
          type: string
        projectIds:
          type: array
          items:
            type: string
            format: uuid

    EcosystemRequest:
      type: object
      properties:
        name:
          type: string
        url:
          type: string
        logoUrl:
          type: string

    EcosystemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        url:
          type: string
        logoUrl:
          type: string

    UpdateInvoiceStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum:
            - APPROVED
            - REJECTED
        rejectionReason:
          type: string
          example: "The invoice is not valid"

    SponsorRequest:
      type: object
      properties:
        name:
          type: string
        url:
          type: string
          format: uri
        logoUrl:
          type: string
          format: uri

    CreateAccountRequest:
      type: object
      required:
        - currencyId
        - allowance
      properties:
        currencyId:
          $ref: '#/components/schemas/CurrencyId'
        allowance:
          type: number
        lockedUntil:
          type: string
          format: date-time
        receipt:
          $ref: '#/components/schemas/TransactionReceipt'

    UpdateAccountAllowanceRequest:
      type: object
      required:
        - allowance
      properties:
        allowance:
          type: number

    RegisterTransactionReceiptRequest:
      type: object
      required:
        - receipt
      properties:
        receipt:
          $ref: '#/components/schemas/TransactionReceipt'

    UpdateAccountRequest:
      type: object
      properties:
        lockedUntil:
          type: string
          format: date-time

    AccountResponse:
      type: object
      required:
        - id
        - sponsorId
        - currencyId
        - balance
        - allowance
        - receipts
      properties:
        id:
          $ref: '#/components/schemas/SponsorAccountId'
        sponsorId:
          $ref: '#/components/schemas/SponsorId'
        currencyId:
          $ref: '#/components/schemas/CurrencyId'
        balance:
          type: number
          description: This is equal to the sum of receipts amounts (including credits and debits)
        allowance:
          type: number
          description: This is the amount of funds available for internal transactions between the sponsor and projects (and eventually contributors)
        awaitingPaymentAmount:
          type: number
          description: This is the sum of reward amounts which have not been paid yet (in the real world)
        lockedUntil:
          type: string
          format: date-time
        receipts:
          type: array
          items:
            $ref: '#/components/schemas/TransactionReceipt'

    AccountListResponse:
      type: object
      required:
        - accounts
      properties:
        accounts:
          type: array
          items:
            $ref: '#/components/schemas/AccountResponse'

    TransactionRequest:
      type: object
      required:
        - type
        - amount
        - currencyId
        - receipt
      properties:
        type:
          $ref: '#/components/schemas/TransactionType'
        amount:
          type: number
        currencyId:
          $ref: '#/components/schemas/CurrencyId'
        lockedUntil:
          type: string
          format: date-time
        receipt:
          $ref: '#/components/schemas/TransactionReceipt'

    TransactionResponse:
      type: object
      required:
        - id
      properties:
        id:
          $ref: '#/components/schemas/TransactionId'

    PendingPaymentListResponse:
      type: object
      required:
        - payments
      properties:
        payments:
          type: array
          items:
            $ref: '#/components/schemas/PendingPaymentResponse'

    PendingPaymentResponse:
      type: object
      required:
        - rewardId
        - recipientAccountNumber
        - amount
        - currency
      properties:
        rewardId:
          $ref: '#/components/schemas/RewardId'
        recipientAccountNumber:
          type: string
        amount:
          type: number
        currency:
          $ref: '#/components/schemas/TransactionalCurrency'

    TransactionType:
      type: string
      enum:
        - CREDIT
        - DEBIT

    TransactionId:
      type: string
      format: uuid

    TransactionReceipt:
      type: object
      required:
        - reference
        - amount
        - network
        - thirdPartyName
        - thirdPartyAccountNumber
      properties:
        id:
          $ref: '#/components/schemas/TransactionReceiptId'
        reference:
          type: string
        amount:
          type: number
        network:
          $ref: '#/components/schemas/TransactionNetwork'
        thirdPartyName:
          type: string
          description: Name of the third party for which the transaction has been made
        thirdPartyAccountNumber:
          type: string
          description: IBAN, account number, ENS or wallet address

    TransactionNetwork:
      type: string
      enum:
        - SWIFT
        - SEPA
        - ETHEREUM
        - OPTIMISM
        - STARKNET
        - APTOS

    ProjectId:
      type: string
      format: uuid

    TransactionReceiptId:
      type: string
      format: uuid

    ProjectBudgetAllocationRequest:
      type: object
      required:
        - sponsorAccountId
        - amount
      properties:
        sponsorAccountId:
          $ref: '#/components/schemas/SponsorAccountId'
        amount:
          type: number

    PayRewardRequest:
      type: object
      required:
        - network
        - reference
        - recipientAccount
      properties:
        network:
          $ref: '#/components/schemas/TransactionNetwork'
        reference:
          type: string
        recipientAccount:
          type: string

    Technologies:
      type: object
      description: List fo technologies ordered by mastering level (the higher the better) or usage (ie. line count of a language)
      additionalProperties:
        type: integer
        format: int64
      example:
        Rust: 91283
        Go: 12388
        Java: 1233
    GithubRepositoryResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        owner:
          type: string
        name:
          type: string
        technologies:
          $ref: '#/components/schemas/Technologies'
        projectId:
          type: string
          format: uuid

    BudgetPage:
      type: object
      required:
        - contributors
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        budgets:
          type: array
          items:
            $ref: '#/components/schemas/BudgetResponse'
    BudgetResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        currency:
          $ref: '#/components/schemas/CurrencyCode'
        initialAmount:
          type: number
        remainingAmount:
          type: number
        spentAmount:
          type: number
        remainingAmountDollarsEquivalent:
          type: number
        initialAmountDollarsEquivalent:
          type: number
        spentAmountDollarsEquivalent:
          type: number
        projectId:
          type: string
          format: uuid

    ProjectLeadInvitationPage:
      type: object
      required:
        - contributors
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        project_lead_invitations:
          type: array
          items:
            $ref: '#/components/schemas/ProjectLeadInvitationResponse'
    ProjectLeadInvitationResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        githubUserId:
          type: integer
          format: int64


    UserPage:
      type: object
      required:
        - users
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        users:
          type: array
          items:
            $ref: '#/components/schemas/UserPageItemResponse'
    UserPageItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        isCompany:
          type: boolean
        companyName:
          type: string
        companyNum:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        address:
          type: string
        country:
          type: string
        telegram:
          type: string
        twitter:
          type: string
        discord:
          type: string
        linkedin:
          type: string
        whatsapp:
          type: string
        bic:
          type: string
        iban:
          type: string
        ens:
          type: string
        ethAddress:
          type: string
        aptosAddress:
          type: string
        optimismAddress:
          type: string
        starknetAddress:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        lastSeenAt:
          type: string
          format: date-time
        email:
          type: string
        githubUserId:
          type: integer
          format: int64
        githubLogin:
          type: string
        githubHtmlUrl:
          type: string
        githubAvatarUrl:
          type: string
        bio:
          type: string
        location:
          type: string
        website:
          type: string
        lookingForAJob:
          type: boolean
        weeklyAllocatedTime:
          type: string
        languages:
          type: array
          items:
            type: string
        tcAcceptedAt:
          type: string
        onboardingCompletedAt:
          type: string
          format: date-time
        verificationStatus:
          $ref: '#/components/schemas/VerificationStatus'
        usEntity:
          type: boolean


    VerificationStatus:
      type: string
      enum:
        - NOT_STARTED
        - STARTED
        - UNDER_REVIEW
        - VERIFIED
        - REJECTED
        - CLOSED
    PaymentPage:
      type: object
      required:
        - payments
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        payments:
          type: array
          items:
            $ref: '#/components/schemas/PaymentPageItemResponse'
    PaymentPageItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        budgetId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        amount:
          type: number
        currency:
          $ref: '#/components/schemas/CurrencyCode'
        recipientId:
          type: integer
          format: int64
        isPayable:
          type: boolean
        payoutSettings:
          type: string
        requestorId:
          type: string
          format: uuid
        items:
          type: array
          items:
            type: string
        requestedAt:
          type: string
          format: date-time
        processedAt:
          type: string
          format: date-time
        pullRequestsCount:
          type: integer
        issuesCount:
          type: integer
        dustyIssuesCount:
          type: integer
        codeReviewsCount:
          type: integer

    InvoicePage:
      type: object
      required:
        - invoices
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        invoices:
          type: array
          items:
            $ref: '#/components/schemas/InvoicePageItemResponse'
    InvoicePageItemResponse:
      type: object
      required:
        - id
        - status
        - internalStatus
        - createdAt
        - dueAt
        - amount
        - currency
        - rewardIds
        - downloadUrl
      properties:
        id:
          $ref: '#/components/schemas/InvoiceId'
        status:
          $ref: '#/components/schemas/InvoiceStatus'
        internalStatus:
          $ref: '#/components/schemas/InvoiceInternalStatus'
        createdAt:
          type: string
          format: date-time
        dueAt:
          type: string
          format: date-time
        amount:
          type: number
        currencyId:
          $ref: '#/components/schemas/CurrencyId'
        rewardIds:
          type: array
          items:
            $ref: '#/components/schemas/RewardId'
        downloadUrl:
          type: string
          format: uri

    InvoiceLinkResponse:
      type: object
      required:
        - id
        - number
        - status
      properties:
        id:
          $ref: '#/components/schemas/InvoiceId'
        number:
          type: string
        status:
          $ref: '#/components/schemas/InvoiceInternalStatus'

    InvoiceResponse:
      type: object
      required:
        - id
        - number
        - status
        - billingProfile
        - createdAt
        - totalEquivalent
        - rewardsPerNetwork
      properties:
        id:
          $ref: '#/components/schemas/InvoiceId'
        number:
          type: string
        status:
          $ref: '#/components/schemas/InvoiceInternalStatus'
        billingProfile:
          $ref: '#/components/schemas/BillingProfileResponse'
        rejectionReason:
          type: string
        createdAt:
          type: string
          format: date-time
        totalEquivalent:
          $ref: '#/components/schemas/MoneyResponse'
        rewardsPerNetwork:
          type: array
          items:
            $ref: '#/components/schemas/InvoiceRewardsPerNetwork'

    InvoiceRewardsPerNetwork:
      type: object
      required:
        - network
        - billingAccountNumber
        - dollarsEquivalent
        - totalPerCurrency
        - rewards
      properties:
        network:
          $ref: '#/components/schemas/TransactionNetwork'
        billingAccountNumber:
          type: string
          description: IBAN, account number, ENS or wallet address
        dollarsEquivalent:
          type: number
        totalPerCurrency:
          type: array
          items:
            $ref: '#/components/schemas/MoneyLinkResponse'
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/InvoiceRewardResponse'

    InvoicePageV2:
      type: object
      required:
        - invoices
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        invoices:
          type: array
          items:
            $ref: '#/components/schemas/InvoicePageItemV2'
    InvoicePageItemV2:
      type: object
      required:
        - id
        - status
        - internalStatus
        - billingProfile
        - createdAt
        - totalAmount
        - totalAmountCurrency
        - rewardCount
        - amounts
      properties:
        id:
          $ref: '#/components/schemas/InvoiceId'
        status:
          $ref: '#/components/schemas/InvoiceInternalStatus'
        billingProfile:
          $ref: '#/components/schemas/BillingProfileResponse'
        createdAt:
          type: string
          format: date-time
        rewardCount:
          type: integer
        totalEquivalent:
          $ref: '#/components/schemas/MoneyLinkResponse'
        totalPerCurrency:
          type: array
          items:
            $ref: '#/components/schemas/MoneyLinkResponse'

    MoneyResponse:
      type: object
      description: An amount and its currency
      required:
        - amount
        - currencyCode
        - currencyName
        - currencyLogoUrl
      properties:
        amount:
          type: number
        currencyCode:
          type: string
        currencyName:
          type: string
        currencyLogoUrl:
          type: string

    MoneyLinkResponse:
      type: object
      description: An amount and its currency
      required:
        - amount
        - currencyCode
        - currencyName
        - currencyLogoUrl
      properties:
        amount:
          type: number
        dollarsEquivalent:
          type: number
        conversionRate:
          type: number
        currencyCode:
          type: string
        currencyName:
          type: string
        currencyLogoUrl:
          type: string

    BillingProfileId:
      type: string
      format: uuid
      description: Billing profile ID

    UserId:
      type: string
      format: uuid
      description: Billing profile ID

    BillingProfileResponse:
      type: object
      required:
        - id
        - name
        - type
        - verificationStatus
      properties:
        id:
          $ref: '#/components/schemas/BillingProfileId'
        name:
          type: string
          example: Apple Inc.
        type:
          $ref: '#/components/schemas/BillingProfileType'
        verificationStatus:
          $ref: '#/components/schemas/VerificationStatus'
        admins:
          type: array
          items:
            $ref: '#/components/schemas/BillingProfileAdminResponse'

    BillingProfileAdminResponse:
      type: object
      required:
        - login
        - email
      properties:
        login:
          type: string
          example: ofux
        name:
          type: string
          example: Olivier Fuxet
        email:
          type: string
          example: olivier@foobar.org
        avatarUrl:
          type: string

    BillingProfileType:
      type: string
      enum:
        - INDIVIDUAL
        - COMPANY
        - SELF_EMPLOYED

    InvoiceInternalStatus:
      type: string
      enum:
        - TO_REVIEW
        - REJECTED
        - APPROVED
        - PAID

    InvoiceStatus:
      type: string
      enum:
        - PROCESSING
        - COMPLETE
        - REJECTED

    ProjectPage:
      type: object
      required:
        - projects
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        projects:
          type: array
          items:
            $ref: '#/components/schemas/ProjectPageItemResponse'
    ProjectPageItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        shortDescription:
          type: string
        longDescription:
          type: string
        moreInfoLinks:
          type: array
          items:
            type: string
        logoUrl:
          type: string
        hiring:
          type: boolean
        rank:
          type: integer
        visibility:
          $ref: '#/components/schemas/ProjectVisibility'
        projectLeads:
          type: array
          items:
            type: string
            format: uuid
        createdAt:
          type: string
          format: date-time
        activeContributors:
          type: integer
          format: int64
        newContributors:
          type: integer
          format: int64
        uniqueRewardedContributors:
          type: integer
          format: int64
        openedIssues:
          type: integer
          format: int64
        contributions:
          type: integer
          format: int64
        dollarsEquivalentAmountSent:
          type: number
        strkAmountSent:
          type: number

    CurrencyCode:
      type: string
      enum:
        - USD
        - ETH
        - APT
        - STRK
        - OP
        - LORDS
        - USDC

    ProjectVisibility:
      type: string
      enum:
        - PUBLIC
        - PRIVATE

    CurrencyCreateRequest:
      type: object
      required:
        - type
      properties:
        type:
          $ref: '#/components/schemas/CurrencyType'
        standard:
          $ref: '#/components/schemas/CurrencyStandard'
        blockchain:
          $ref: '#/components/schemas/BlockchainContract'
        address:
          $ref: '#/components/schemas/ContractAddress'
        logoUrl:
          type: string
          format: uri
        description:
          type: string
        code:
          type: string
        decimals:
          type: integer

    CurrencyUpdateRequest:
      type: object
      properties:
        name:
          type: string
        logoUrl:
          type: string
          format: uri
        decimals:
          type: integer
        description:
          type: string

    CurrencyListResponse:
      type: object
      properties:
        currencies:
          type: array
          items:
            $ref: '#/components/schemas/CurrencyResponse'

    CurrencyResponse:
      allOf:
        - $ref: '#/components/schemas/Currency'
        - type: object
          required:
            - type
            - decimals
          properties:
            type:
              $ref: '#/components/schemas/CurrencyType'
            tokens:
              type: array
              items:
                $ref: '#/components/schemas/Token'
            decimals:
              type: integer
            description:
              type: string

    Token:
      type: object
      properties:
        blockchain:
          $ref: '#/components/schemas/BlockchainContract'
        address:
          $ref: '#/components/schemas/ContractAddress'
        decimals:
          type: integer
        symbol:
          type: string
        name:
          type: string

    UploadImageResponse:
      type: object
      properties:
        url:
          type: string
          format: url
          description: The direct URL to the uploaded image
      example:
        url: https://onlydust-app-images.s3.eu-west-1.amazonaws.com/4137005338789730434.png

    TransactionData:
      type: object
      description: Contains the necessary information to perform a transaction.
      required:
        - amount
        - currency
      properties:
        amount:
          type: number
        currency:
          $ref: '#/components/schemas/TransactionalCurrency'

    AllocationData:
      type: object
      description: Available budget that can be allocated
      required:
        - amount
        - currency
      properties:
        amount:
          type: number
        currency:
          $ref: '#/components/schemas/Currency'

    Currency:
      type: object
      description: Minimal information about a currency
      properties:
        id:
          $ref: '#/components/schemas/CurrencyId'
        code:
          type: string
          example: USDC
        name:
          type: string
          example: USD Coin
        logoUrl:
          type: string
          format: uri

    TransactionalCurrency:
      allOf:
        - $ref: '#/components/schemas/Currency'
        - type: object
          description: Information about a currency that can be used to perform transactions
          required:
            - type
          properties:
            type:
              $ref: '#/components/schemas/CurrencyType'
            standard:
              $ref: '#/components/schemas/CurrencyStandard'
            blockchain:
              $ref: '#/components/schemas/BlockchainContract'
            address:
              $ref: '#/components/schemas/ContractAddress'

    SponsorId:
      type: string
      format: uuid

    InvoiceId:
      type: string
      format: uuid

    RewardId:
      type: string
      format: uuid

    SponsorAccountId:
      type: string
      format: uuid

    CurrencyId:
      type: string
      format: uuid

    CurrencyType:
      type: string
      enum:
        - FIAT
        - CRYPTO

    CurrencyStandard:
      type: string
      enum:
        - ISO4217
        - ERC20

    BlockchainContract:
      type: string
      enum:
        - ETHEREUM
        - OPTIMISM
        - STARKNET
        - APTOS

    ContractAddress:
      type: string
      format: hex
    
    SearchRewardsRequest:
      type: object
      required:
        - invoiceIds
      properties:
        invoiceIds:
          type: array
          items:
            $ref: '#/components/schemas/InvoiceId'
    
    SearchRewardsResponse:
      type: object
      required:
        - rewards
      properties:
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/SearchRewardItemResponse'

    SearchRewardItemResponse:
      type: object
      required:
        - id
        - billingProfileAdmin
        - requestedAt
        - githubUrls
        - project
      properties:
        id:
          $ref: '#/components/schemas/RewardId'
        billingProfile:
          $ref: '#/components/schemas/BillingProfileResponse'
        requestedAt:
          type: string
          format: date-time
        processedAt:
          type: string
          format: date-time
        githubUrls:
          type: array
          items:
            type: string
        project:
          $ref: '#/components/schemas/ProjectLinkResponse'
        sponsors:
          type: array
          items:
            $ref: '#/components/schemas/SponsorLinkResponse'
        money:
          $ref: '#/components/schemas/MoneyLinkResponse'

    RewardPageResponse:
      type: object
      required:
        - rewards
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/RewardPageItemResponse'
    RewardPageItemResponse:
      type: object
      required:
        - id
        - billingProfileAdmin
        - requestedAt
        - githubUrls
        - project
      properties:
        id:
          $ref: '#/components/schemas/RewardId'
        billingProfile:
          $ref: '#/components/schemas/BillingProfileResponse'
        invoice:
          $ref: '#/components/schemas/InvoiceLinkResponse'
        status:
          $ref: '#/components/schemas/RewardStatus'
        requestedAt:
          type: string
          format: date-time
        processedAt:
          type: string
          format: date-time
        githubUrls:
          type: array
          items:
            type: string
        recipient:
          $ref: '#/components/schemas/RecipientLinkResponse'
        project:
          $ref: '#/components/schemas/ProjectLinkResponse'
        sponsors:
          type: array
          items:
            $ref: '#/components/schemas/SponsorLinkResponse'
        money:
          $ref: '#/components/schemas/MoneyLinkResponse'
        transactionHash:
          type: string
          example: 0x1234567890abcdef
        paidTo:
          type: string
          example: 0x1234567890abcdef

    RewardStatus:
      enum:
        - PENDING_INVOICE
        - PENDING_SIGNUP
        - PENDING_CONTRIBUTOR
        - PENDING_VERIFICATION
        - MISSING_PAYOUT_INFO
        - PROCESSING
        - COMPLETE
        - LOCKED

    RecipientLinkResponse:
      type: object
      required:
        - login
        - avatarUrl
      properties:
        login:
          type: string
        name:
          type: string
        avatarUrl:
          type: string

    InvoiceRewardResponse:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/RewardId'
        requestedAt:
          type: string
          format: date-time
        processedAt:
          type: string
          format: date-time
        githubUrls:
          type: array
          items:
            type: string
        project:
          $ref: '#/components/schemas/ProjectLinkResponse'
        sponsors:
          type: array
          items:
            $ref: '#/components/schemas/SponsorLinkResponse'
        money:
          $ref: '#/components/schemas/MoneyLinkResponse'
        transactionHash:
          type: string

    ProjectLinkResponse:
      type: object
      required:
        - name
        - logoUrl
      properties:
        name:
          type: string
        logoUrl:
          type: string

    SponsorLinkResponse:
      type: object
      required:
        - name
        - avatarUrl
      properties:
        name:
          type: string
        avatarUrl:
          type: string

    PostBatchPaymentRequest:
      type: object
      required:
        - invoiceIds
      properties:
        invoiceIds:
          type: array
          items:
            $ref: '#/components/schemas/InvoiceId'

    BatchPaymentId:
      type: string
      format: uuid
    BatchPaymentsResponse:
      type: object
      required:
        - batchPayments
      properties:
        batchPayments:
          type: array
          items:
            $ref: '#/components/schemas/BatchPaymentResponse'
    BatchPaymentResponse:
      type: object
      required:
        - id
        - csv
        - rewardCount
        - totalAmounts
        - blockchain
      properties:
        id:
          $ref: '#/components/schemas/BatchPaymentId'
        csv:
          type: string
        blockchain:
          $ref: '#/components/schemas/BlockchainContract'
        rewardCount:
          type: integer
          format: int64
        totalAmounts:
          items:
            $ref: '#/components/schemas/MoneyLinkResponse'

    BatchPaymentRequest:
      type: object
      required:
        - transactionHash
      properties:
        transactionHash:
          type: string

    BatchPaymentPageResponse:
      required:
        - batchPayments
        - totalPageNumber
        - totalItemNumber
        - nextPageIndex
        - hasMore
      properties:
        totalPageNumber:
          type: integer
        totalItemNumber:
          type: integer
        hasMore:
          type: boolean
        nextPageIndex:
          description: if there is no next page, it will be equals to the last page
          type: integer
        batchPayments:
          type: array
          items:
            $ref: '#/components/schemas/BatchPaymentItemResponse'

    BatchPaymentItemResponse:
      type: object
      required:
        - id
        - createdAt
        - blockchain
        - rewardCount
        - totalAmounts
        - totalAmountUsd
      properties:
        id:
          $ref: '#/components/schemas/BatchPaymentId'
        createdAt:
          type: string
          format: date-time
        blockchain:
          $ref: '#/components/schemas/BlockchainContract'
        rewardCount:
          type: integer
          format: int64
        totalAmountUsd:
          type: number
        totalAmounts:
          items:
            $ref: '#/components/schemas/MoneyLinkResponse'

    BatchPaymentDetailsResponse:
      allOf:
        - $ref: '#/components/schemas/BatchPaymentItemResponse'
        - $ref: '#/components/schemas/SearchRewardsResponse'
        - type: object
          properties:
            csv:
              type: string
            transactionHash:
              type: string